Below is a **paste-ready, QC-heavy Agent Manager instruction** that explicitly prevents the “only week01” failure mode and forces the agent to (1) update **all 14 chapters**, (2) improve/verify **all 14 lesson codes**, (3) compile the full LaTeX book, (4) run all demos/checks, (5) produce **a new ZIP** containing everything.

---

# ✅ Agent Manager Instruction — Textbook + Code Refactor (14 Weeks) with Hard QC + ZIP Output

You are the **Agent Manager**. Your task is to transform an existing repository (provided as `dsp.zip`) into a **complete 14-chapter LaTeX textbook** + **improved, verified Python lesson code** for Weeks 01–14, then package the entire improved repository into a **new ZIP**.

This task is **NOT complete** until **all 14 weeks** pass QC checks and a new ZIP file is produced.

---

## 0) Inputs Provided to You

A ZIP archive will be attached: **`dsp.zip`**.

Inside it you will find:

### A) Slide specs (ground truth for chapter structure)

* `slides_spec/week_01.json`
* …
* `slides_spec/week_14.json`

You must read **all** week specs before writing.

### B) Draft lesson code (one folder per week)

Example (Week 01):

* `lessons/lesson_01/demo.py`
* `lessons/lesson_01/checks.py`
* `lessons/lesson_01/README.md`

Weeks 02–14 should follow a similar structure (you must discover actual folder names and adapt).

### C) LaTeX entrypoint

* `writing/main.tex`

---

## 1) Deliverables (Must Produce)

### 1.1 LaTeX textbook (14 chapters)

Create or update **exactly**:

* `writing/week1.tex`
* `writing/week2.tex`
* …
* `writing/week14.tex`

And update `writing/main.tex` so it includes **all** chapters:

```tex
\include{week1}
\include{week2}
...
\include{week14}
```

### 1.2 Improved lesson code (Weeks 01–14)

For each week’s lesson folder:

* Improve `demo.py` and `checks.py` where necessary
* Ensure both run cleanly
* Update `README.md` with clear run instructions and expected outputs

### 1.3 Full execution verification

You must execute:

* `python lessons/lesson_##/demo.py`
* `python lessons/lesson_##/checks.py`

for **all 14 weeks** and ensure they succeed.

### 1.4 Full book build verification

You must compile the full LaTeX book (all 14 includes) successfully.

### 1.5 QC report (mandatory)

Create `QC_REPORT.md` at repo root with:

* a checklist table for Weeks 1–14 (PASS/FAIL)
* reasons for any fixes
* commands used to run code and build LaTeX
* final confirmation that all checks passed

### 1.6 Final packaging (mandatory)

Create a new zip archive:

* `dsp_improved.zip`

It must contain:

* the updated `writing/` folder (main.tex + week1..week14.tex + any bib/figures)
* the updated `lessons/` folder for all weeks
* any added helper modules or requirements updates
* QC report file(s)

**Do not omit files** needed to run or build.

---

## 2) Ethos and Content Rules (Book vs Slides)

### Book is more detailed than slides

Slides are brief; the book must expand explanations and be suitable for self-study.

### Still black-box (no derivations)

You may include **more formulas** than slides, but:

* **no derivations**
* every formula must include:

    * symbol definitions
    * what you plug in / what you get out
    * interpretation guidance
    * parameter tuning rules-of-thumb

### Always teach the operational workflow

For every method:
**Inputs → Knobs/parameters → Outputs → Failure modes → Diagnostics/Fixes → Industrial decision**

### Internet usage required

You must use the internet to gather:

* operational DSP formulas (without derivations)
* parameter heuristics (e.g., window choice, filter order intuition, overlap suggestions)
* known pitfalls and how to detect them
* citations from authoritative sources (SciPy/NumPy docs, reputable DSP references)

Add citations in the book (BibTeX preferred, footnotes acceptable).

---

## 3) Chapter Template (Must Apply to Every Week)

Each `writing/weekX.tex` must include:

1. **Chapter title + learning objectives**
2. **Industrial context** aligned with that week’s slide spec
3. **Core concepts** (expanded explanation)
4. **Operational formulas** (no derivations)
5. **Parameter tuning playbook**

    * include a table: knob | default | if you see X | change Y
6. **Pitfalls / failure modes / diagnostics**

    * symptom → likely cause → quick fix
7. **Code walkthrough**

    * explain `demo.py` flow
    * key functions/blocks and parameters
    * expected plots/metrics
    * describe failure demo and how to detect it
8. **Exercises**

    * aligned to what `checks.py` validates
9. **References**

    * cite non-trivial rules and claims

---

## 4) Code Improvement Rules (Must Apply to Every Week)

For each `lessons/lesson_##/`:

### Must run cleanly

* `demo.py` executes end-to-end
* `checks.py` executes and passes
* no manual steps beyond documented install/run

### Must be reproducible

* fixed random seeds where relevant
* deterministic outputs where possible

### Must include:

* at least one “happy path”
* at least one “failure case” (and detection logic)
* at least **2 assertable checks** in `checks.py` aligned to completion criteria

### Dependencies

* keep minimal: `numpy`, `scipy`, `matplotlib` (optional `pandas`)
* update `requirements.txt` / `pyproject.toml` only if needed
* do not introduce heavy or obscure libraries unless absolutely required

---

## 5) Mandatory Workflow (Prevents “Only Week01” Output)

### Step A — Inventory (Hard requirement)

1. List and confirm existence of:

    * `slides_spec/week_01.json` … `slides_spec/week_14.json`
2. Discover lesson folders:

    * map week numbers to lesson folders (e.g., `lesson_01` → Week 1)
3. Confirm `writing/main.tex` exists

Create a mapping table in `QC_REPORT.md`:

| Week | slides_spec file | lesson folder | tex output |
| ---- | ---------------- | ------------- | ---------- |
| 01   | week_01.json     | lesson_01     | week1.tex  |
| …    | …                | …             | …          |
| 14   | week_14.json     | lesson_14     | week14.tex |

**If any week is missing a lesson folder or files, you must create a minimal scaffold** (demo/checks/README) so the week can still pass QC.

### Step B — Batch execution (Hard requirement)

You must process weeks in batches and only proceed when the batch passes QC:

* Batch 1: Weeks 01–03
* Batch 2: Weeks 04–06
* Batch 3: Weeks 07–09
* Batch 4: Weeks 10–11
* Batch 5: Weeks 12–14

For each batch, do:

1. Read slide specs for those weeks
2. Improve code for those weeks
3. Run code for those weeks
4. Write chapters for those weeks
5. Compile LaTeX (at least for included chapters so far)
6. Update QC report (PASS/FAIL)

### Step C — Final integration (Hard requirement)

Only after all batches pass:

* update `writing/main.tex` to include all 14 weeks
* compile full book
* run all week demos/checks again (final sweep)
* generate `dsp_improved.zip`

---

## 6) Strict QC Gates (Auto-Fail Rules)

A week is **FAIL** unless all are true:

### Week-level gates

* **G1:** `writing/weekX.tex` exists and follows the chapter template
* **G2:** chapter includes operational formulas + symbol definitions + interpretation (no derivation)
* **G3:** chapter includes code walkthrough referencing actual lesson files
* **G4:** `python lessons/lesson_##/demo.py` runs without error
* **G5:** `python lessons/lesson_##/checks.py` runs and passes
* **G6:** chapter exercises align with what checks validate
* **G7:** citations included for non-trivial heuristics/claims

### Book-level gates

* **B1:** `writing/main.tex` includes week1..week14 (all 14)
* **B2:** full LaTeX build succeeds (no missing includes)
* **B3:** no missing figures/refs/packages required for build

### Packaging gate

* **P1:** `dsp_improved.zip` exists and contains:

    * all `writing/week*.tex`
    * updated `writing/main.tex`
    * updated `lessons/` for all weeks
    * `QC_REPORT.md`

If any gate fails → fix and re-run until PASS.

---

## 7) Final Output Rule (Prevents Partial Delivery)

You must **not stop** after Week 01.
Your output is only acceptable if:

* All 14 chapters exist
* All 14 weeks of code run and checks pass
* The full book compiles
* A new ZIP (`dsp_improved.zip`) is produced

---

## 8) What You Must Return

1. A summary of changes (high-level)
2. The updated files in the repository structure
3. `QC_REPORT.md` with PASS for all weeks and book build
4. The generated `dsp_improved.zip`

---

If you want, I can also add a very explicit “final sweep script” requirement (e.g., `scripts/run_all.py`) to enforce automated execution across all 14 weeks—but the instruction above already forces the manager to prove completion via QC gates and ZIP packaging.
